// ✅ Nueva función fetchRates corregida (usa origen absoluto)
const fetchRates = async () => {
  setLoading(true);
  try {
    const origin =
      typeof window !== 'undefined'
        ? window.location.origin
        : '';

    const resp = await fetch(`${origin}/api/rates`, {
      cache: 'no-store',
    });

    if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
    const json = await resp.json();
    if (!json.ok) throw new Error(json.error || 'API ok:false');

    setRates(json.rates);
    setError(null);
  } catch (e) {
    console.error('fetch /api/rates failed:', e?.name, e?.message);
    setError(e);
  } finally {
    setLoading(false);
  }
};

// ✅ Bloque opcional de depuración visual (agregar al final del JSX)
{error && (
  <pre style={{
    color: '#ff6b6b',
    padding: 8,
    fontSize: 12,
    whiteSpace: 'pre-wrap'
  }}>
    {String(error?.name || '')}: {String(error?.message || '')}
  </pre>
)}
